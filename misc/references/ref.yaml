asyncapi: 2.5.0
info:
  title: Feline
  description: Feline server description here
  version: '1.0'
  contact: {}
tags: []
servers:
  europe: &ref_0
    url: ws://0.0.0.0:4001
    protocol: socket.io
    protocolVersion: '4'
    description: >-
      Allows you to connect using the websocket protocol to our Socket.io
      server.
    security:
      - user-password: []
    variables:
      port:
        description: Secure connection (TLS) is available through port 443.
        default: '443'
    bindings: {}
  asia: *ref_0
  north-america: *ref_0
  south-america: *ref_0
  africa: *ref_0
  australia: *ref_0
components:
  securitySchemes:
    user-password:
      type: userPassword
  schemas:
    CreateFelineDto:
      type: object
      properties:
        correlationId:
          type: string
          format: uuid
        version:
          type: string
          format: x.y.z
          example: 1.0.1
        payload:
          oneOf:
            - $ref: '#/components/schemas/Cat'
            - $ref: '#/components/schemas/Lion'
            - $ref: '#/components/schemas/Tiger'
        timestamp:
          format: date-time
          type: string
      required:
        - correlationId
        - version
        - payload
        - timestamp
    FelineRto:
      type: object
      properties:
        correlationId:
          type: string
          format: uuid
        version:
          type: string
          format: x.y.z
          example: 1.0.1
        payload:
          oneOf: &ref_1
            - $ref: '#/components/schemas/Cat'
            - $ref: '#/components/schemas/Lion'
            - $ref: '#/components/schemas/Tiger'
        timestamp:
          format: date-time
          type: string
      required:
        - correlationId
        - version
        - payload
        - timestamp
    FelineExtendedRto:
      type: object
      properties:
        correlationId:
          type: string
          format: uuid
        version:
          type: string
          format: x.y.z
          example: 1.0.1
        payload:
          oneOf: *ref_1
        timestamp:
          format: date-time
          type: string
      required:
        - correlationId
        - version
        - payload
        - timestamp
    JournalingDataDto:
      type: object
      properties:
        correlationId:
          type: string
          format: uuid
        version:
          type: string
          format: x.y.z
          example: 1.0.1
        payload:
          type: object
        timestamp:
          format: date-time
          type: string
      required:
        - correlationId
        - version
        - payload
        - timestamp
    Cat:
      type: object
      properties:
        breed:
          type: string
          example: Maine Coon
        id:
          type: number
        name:
          type: string
        age:
          type: number
        gender:
          type: string
          enum:
            - male
            - female
        dominantPaw:
          type: string
          enum:
            - left
            - right
        tags:
          type: array
          items:
            type: string
        birthDatetime:
          format: date-time
          type: string
      required:
        - breed
        - id
        - name
        - age
        - gender
        - dominantPaw
        - tags
        - birthDatetime
    Lion:
      type: object
      properties:
        roarVolume:
          type: number
        id:
          type: number
        name:
          type: string
        age:
          type: number
        gender:
          type: string
          enum:
            - male
            - female
        dominantPaw:
          type: string
          enum:
            - left
            - right
        tags:
          type: array
          items:
            type: string
        birthDatetime:
          format: date-time
          type: string
      required:
        - roarVolume
        - id
        - name
        - age
        - gender
        - dominantPaw
        - tags
        - birthDatetime
    Tiger:
      type: object
      properties:
        numberOfStripes:
          type: number
        id:
          type: number
        name:
          type: string
        age:
          type: number
        gender:
          type: string
          enum:
            - male
            - female
        dominantPaw:
          type: string
          enum:
            - left
            - right
        tags:
          type: array
          items:
            type: string
        birthDatetime:
          format: date-time
          type: string
      required:
        - numberOfStripes
        - id
        - name
        - age
        - gender
        - dominantPaw
        - tags
        - birthDatetime
    Feline:
      type: object
      properties:
        id:
          type: number
        name:
          type: string
        age:
          type: number
        gender:
          type: string
          enum:
            - male
            - female
        dominantPaw:
          type: string
          enum:
            - left
            - right
        tags:
          type: array
          items:
            type: string
        birthDatetime:
          format: date-time
          type: string
      required:
        - id
        - name
        - age
        - gender
        - dominantPaw
        - tags
        - birthDatetime
defaultContentType: application/json
channels:
  ws/create/feline:
    subscribe:
      message:
        oneOf:
          - name: 'oneOf demo #1'
            payload:
              $ref: '#/components/schemas/FelineRto'
          - name: 'oneOf demo #2'
            payload:
              $ref: '#/components/schemas/FelineExtendedRto'
    publish:
      message:
        payload:
          $ref: '#/components/schemas/CreateFelineDto'
        name: FelinesGateway#createFeline
  ms/journal:
    subscribe:
      message:
        payload:
          $ref: '#/components/schemas/JournalingDataDto'
        name: FelinesController#journal
  ms/create/feline:
    subscribe:
      message:
        payload:
          $ref: '#/components/schemas/FelineRto'
        name: FelinesController#publishCreatedFeline
    publish:
      message:
        payload:
          $ref: '#/components/schemas/CreateFelineDto'
        name: FelinesController#createFeline
